!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("brewcalc",[],e):"object"==typeof exports?exports.brewcalc=e():t.brewcalc=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=3)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},o=e.kgToOunces=function(t){return 35.2739619*t},a=(e.kgToPounds=function(t){return o(t)/16},e.poundsTokg=function(t){return t/2.204},e.litersToOunces=function(t){return t/.0295735}),u=(e.ouncesToLiters=function(t){return.0295735*t},e.litersToGallons=function(t){return a(t)/128},e.fahrenheitToCelsius=function(t){return(t-32)/1.8},e.celsiusToFahrenheit=function(t){return 1.8*t+32},e.kpaToPsi=function(t){return.14503773773020923*t},e.psiTokpa=function(t){return 6.894757293168361*t},e.sgToPlato=function(t){return 1262.45*t-668.962-776.43*Math.pow(t,2)+182.94*Math.pow(t,3)},e.platoTosg=function(t){return 1+t/(258.6-t/258.2*227.1)},e.sum=function(t){return t.reduce(function(t,e){return t+e},0)},function(t,e){return e.map(function(e){return r({},e,{amount:t*e.amount})})});e.scaleRecipe=function(t,e){var n=e.batchSize,o=n/t.batchSize;return r({},t,{batchSize:n,fermentables:u(o,t.fermentables),hops:u(o,t.hops)})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.FermentableTypes={grain:"Grain",sugar:"Sugar",extract:"Extract",dryExtract:"Dry Extract",adjunct:"Adjunct"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.MashType={infusion:"Infusion",temperature:"Temperature",decoction:"Decoction"}},function(t,e,n){"use strict";n(4),n(6),n(8),n(0),n(9),n(10)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.calcCalories=e.carbonation=e.yeastStarterGrow=e.yeastCount=e.yeastNeeded=e.srmToCss=e.colorSRM=e.srmToRgb=e.estABVrealExtract=e.estABV=e.estABW=e.gravityPoints=e.boilGravity=e.finalGravity=e.originalGravity=void 0;var r=n(1),o=n(0),a=n(5),u=(e.originalGravity=function(t,e){return 1+e/(0,o.litersToGallons)(t)},e.finalGravity=function(t,e){return 1+e/(0,o.litersToGallons)(t)},e.boilGravity=function(t,e,n){return 1+(n-1)*(0,o.litersToGallons)(t)/(0,o.litersToGallons)(e)},function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(t-1)*(0,o.kgToPounds)(e)*n}),i=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return t===r.FermentableTypes.extract||t===r.FermentableTypes.sugar||t===r.FermentableTypes.dryExtract?n:e},s=(e.gravityPoints=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,o.sum)(t.map(function(t){var r=t.type,o=t.potential,a=t.amount;return u(o,a,(1-n)*i(r,e))}))},e.estABW=function(t,e){return.105*(t-e)},e.estABV=function(t,e){return.132*(t-e)},e.estABVrealExtract=function(t,e){var n=(0,o.sgToPlato)(t);return(n-(.1808*n+.8192*(0,o.sgToPlato)(e)))/(2.0665-.010665*n)*(e/.79661)},function(t){return 1.4922*Math.pow(t,.6859)}),c=function(t){var e=t.amount,n=t.color;return(0,o.kgToPounds)(e)*n},l=e.srmToRgb=function(t){return{r:Math.round(Math.min(255,Math.max(0,255*Math.pow(.975,t)))),g:Math.round(Math.min(255,Math.max(0,255*Math.pow(.88,t)))),b:Math.round(Math.min(255,Math.max(0,255*Math.pow(.7,t))))}},f=(e.colorSRM=function(t,e){return s((0,o.sum)(t.map(c))/(0,o.litersToGallons)(e))},e.srmToCss=function(t){var e=l(t);return"rgb("+e.r+", "+e.g+", "+e.b+")"},e.yeastNeeded=function(t,e,n){return t*(1e3*e)*n/1e3},function(t,e){return 100-.7*Math.floor((Date.parse(t)-Date.parse(e))/864e5)}),p=function(){(void 0).message="I dont know how to calculate Culture yeasts yet",(void 0).name="NotImplementedError"},m=(e.yeastCount=function(t){var e=t.amount,n=t.form,r=t.cultureDate,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(new Date).toString(),u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;switch(n){case a.YeastForms.dry:return u*e*1e3;case a.YeastForms.liquid:return f(o,r)/100*100*e;case a.YeastForms.slant:return i*e*1e3;default:throw p()}},function(t){return 2.33-.67*t}),d=function(t){return t<1.4?1.4:t>=1.4&&t<=3.5&&m(t)>0?m(t):0},h=(e.yeastStarterGrow=function(t,e,n,r){var a=(0,o.litersToGallons)(e),u=a*(n-1)*1e3,i=u/42,s=1e3*(0,o.poundsTokg)(i),c=t/s,l=d(c),f=s*l+t;return{growthRate:l,endingCount:f,pitchRate:1e3*f/(0,o.sgToPlato)(n)/(r/1e3)}},function(t,e){return Math.max(0,-16.6999-.0101059*e+.00116512*e*e+.173354*e*t+4.24267*t-.0684226*t*t)}),g=function(t,e,n){return 15.195*n*(t-3.0378+.050062*e-26555e-8*e*e)},v=function(t){return Math.max(32,(0,o.celsiusToFahrenheit)(t))},y=(e.carbonation=function(t,e,n){var r=g(t,v(e),(0,o.litersToGallons)(n));return{kegPressure:h(t,v(e)),kegSugar:.5*r,cornSugar:r,dme:1.538*r}},function(t,e){return 1881.22*e*((t-e)/(1.775-t))}),b=function(t,e){return 3550*e*(.1808*t+.8192*e-1.0004)};e.calcCalories=function(t,e){return y(t,e)+b(t,e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.YeastTypes={ale:"Ale",lager:"Lager",wheat:"Wheat",wine:"Wine",champagne:"Champagne"},e.YeastForms={liquid:"Liquid",dry:"Dry",slant:"Slant",culture:"Culture"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.bitternessIbuRager=e.ragerHopIbu=e.bitternessRatio=e.bitternessIbuTinseth=void 0;var r=n(0),o=n(7),a=function(t,e,n){return 1.65*n*Math.pow(125e-6,t)*(1-Math.pow(Math.E,-.04*e))/4.15},u=(e.bitternessIbuTinseth=function(t,e,n){return(0,r.sum)(t.map(function(t){var u=t.amount,i=t.alpha,s=t.form,c=t.time;return a(e,c,s===o.HopForms.pellet?1.1:1)*(0,r.kgToOunces)(u)*i*7490/(0,r.litersToGallons)(n)}))},e.bitternessRatio=function(t,e){return t/e},function(t){return t<=1.05?0:(t-1.05)/.2}),i=function(t){return 18.11+13.86*Math.tanh((t-31.32)/18.27)},s=function(t,e,n,r,o,a){return t*e*n*a/(r*(1+o))},c=e.ragerHopIbu=function(t,e,n,r,o){return n<=0||t<=0||e<0?0:s(.01*i(Math.floor(n+.5)),e,t,o,u(r),100/1.34)};e.bitternessIbuRager=function(t,e,n){return(0,r.sum)(t.map(function(t){var o=t.amount,a=t.alpha,u=t.time;return c((0,r.kgToOunces)(o),100*a,u,e,(0,r.litersToGallons)(n))}))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.HopUse={boil:"Boil",dryHop:"DryHop",mash:"Mash",firstWort:"FirstWort",aroma:"Aroma"},e.HopForms={pellet:"Pellet",plug:"Plug",leaf:"Leaf"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.mashRecalculate=void 0;var r=n(2),o=function(t,e){return t*e+(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0)+(arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)},a=function(t,e,n){return t*=.8,t>0&&e<t?n*e/t:n},u=function(t,e,n,r,u,i,s,c){var l=o(.652,r,e),f=a(s,l,u),p=(.38*r+i*f+e)/(.38*r+e)*(t-n)/(c-n);return p>1&&(p=1),l*p},i=function(t,e,n,r,u,i,s,c){if(t<=0)return e;var l=o(.652,u,t,n);return e+(.38*u+s*a(c,l,i)+n)*(e-r)/t},s=function(t,e,n,r,u,i,s,c){if(0===t)return e;var l=o(.652,n,t);return e+(.38*n*(e-r)+i*a(s,l,u)*(e-c))/t};e.mashRecalculate=function(t,e,n){var o=t.mashSteps,a=t.equipAdjust,c=t.grainTemp,l=t.tunTemp,f=e.tunWeight,p=e.tunSpecificHeat,m=e.tunVolume,d=a?f:0,h=function(t,e){return 0===t?e+0:e},g=function(t,e){return e.slice(0,t).reduce(function(t,e,n){return e.type!==r.MashType.decoction?h(n,e.infuseAmount):0},0)};return o.map(function(t,e,o){var a=(t.name,t.type),f=t.infuseAmount,v=t.stepTemp,y=h(e,f),b=g(e,o),M={};switch(a){case r.MashType.infusion:M.infussionTemp=0===e?s(y,v,n,c,d,p,m,l):i(y,v,b,o[e-1].stepTemp,n,d,p,m),M.decoctionAmount=0;break;case r.MashType.decoction:M.infussionTemp=0===e?s(y,v,n,c,d,p,m,l):0,M.decoctionAmount=0===e?0:u(v,b,o[e-1].stepTemp,n,d,p,m,100)}return{infuseStepAmount:y,infussionTemp:M.infussionTemp,decoctionAmount:M.decoctionAmount}})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.calculateVolumes=void 0;var r=n(0),o=n(1),a=n(2);e.calculateVolumes=function(t,e){var n=t.fermentables,u=t.mash,i=t.boilTime,s=e.lauterDeadspace,c=e.boilSize,l=e.evapRate,f=e.coolingLossPct,p=e.trubChillerLoss,m=e.topUpKettle,d=e.BIAB,h=(0,r.sum)(n.map(function(t){var e=t.amount;return t.type===o.FermentableTypes.grain?e:0})),g=d?.586:.96,v=(0,r.ouncesToLiters)((0,r.kgToOunces)(h)*g),y=s+(0,r.sum)(u.mashSteps.map(function(t){var e=t.type,n=t.infuseAmount;return e!==a.MashType.decoction?n:0})),b=y+.67*h,M=y-v,T=c+v-m+s-y,C=M+(T-s),O=C*l*(i/60),S=C-O,P=S*f;return{totalWater:y+T,mashGrainWeight:h,grainAbsorbtion:v,totalMashWaterAdds:y,mashVolumeNeeded:b,waterAvailFromMash:M,spargeVol:T,estPreBoilVolume:C,boilOffVolume:O,postBoilVolume:S,coolingShrinkage:P,estBottlingVol:S-P-p-0-1.7}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.calcWaterChemistry=void 0;var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},o=n(0),a=function(t,e){return Math.round(t*(1-e))},u=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Math.round(t*(1-e)*(50/61))},i=function(t,e){var n=e.CaCO3,r=e.NaHCO3,o=e.CaSO4,a=e.CaCl2,i=e.MgSO4,s=e.NaCl,c=0,l=0,f=0,p=0,m=0,d=0;return n/=2,n>0&&(c+=105*n/t,d+=321*n/t),r>0&&(p+=75*r/t,d+=191*r/t),o>0&&(c+=61.5*o/t,f+=147.4*o/t),a>0&&(c+=72*a/t,m+=127*a/t),i>0&&(l+=26*i/t,f+=103*i/t),s>0&&(p+=104*s/t,m+=160*s/t),{name:"adjustmentsFromSalts",Ca:Math.round(c),Mg:Math.round(l),SO4:Math.round(f),Na:Math.round(p),Cl:Math.round(m),HCO3:Math.round(d),alkalinity:u(Math.round(d))}};e.calcWaterChemistry=function(t,e,n,s,c){var l=i((0,o.litersToGallons)(t),r({},c)),f={name:"dilutedWater",Ca:a(n.Ca,e),Mg:a(n.Mg,e),SO4:a(n.SO4,e),Na:a(n.Na,e),Cl:a(n.Cl,e),HCO3:a(n.HCO3,e),alkalinity:u(n.HCO3,e)},p={name:"adjustedWater",Ca:f.Ca+l.Ca,Mg:f.Mg+l.Mg,SO4:f.SO4+l.SO4,Na:f.Na+l.Na,Cl:f.Cl+l.Cl,HCO3:f.HCO3+l.HCO3,alkalinity:u(f.HCO3+l.HCO3)};return{adjustedWater:p,dilutedWater:f,adjustmentsFromSalts:l,difference:{name:"difference source water from target",Ca:p.Ca-s.Ca,Mg:p.Mg-s.Mg,SO4:p.SO4-s.SO4,Na:p.Na-s.Na,Cl:p.Cl-s.Cl,HCO3:p.HCO3-s.HCO3,alkalinity:u(p.HCO3-s.HCO3)},sulphateChlorideRatio:p.SO4/p.Cl}}}])});