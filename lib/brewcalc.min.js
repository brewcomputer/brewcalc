!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("brewcalc",[],t):"object"==typeof exports?exports.brewcalc=t():e.brewcalc=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=5)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=t.kgToOunces=function(e){return 35.2739619*e},a=(t.kgToPounds=function(e){return o(e)/16},t.poundsTokg=function(e){return e/2.204},t.litersToOunces=function(e){return e/.0295735}),s=(t.ouncesToLiters=function(e){return.0295735*e},t.litersToGallons=function(e){return a(e)/128},t.fahrenheitToCelsius=function(e){return(e-32)/1.8},t.celsiusToFahrenheit=function(e){return 1.8*e+32},t.kpaToPsi=function(e){return.14503773773020923*e},t.psiTokpa=function(e){return 6.894757293168361*e},t.sgToPlato=function(e){return 1262.45*e-668.962-776.43*Math.pow(e,2)+182.94*Math.pow(e,3)},t.platoTosg=function(e){return 1+e/(258.6-e/258.2*227.1)},t.sum=function(e){return e.reduce(function(e,t){return e+t},0)},function(e,t){return t.map(function(t){return n({},t,{amount:e*t.amount})})});t.scaleRecipe=function(e,t){var r=t.batchSize,o=r/e.batchSize;return n({},e,{batchSize:r,fermentables:s(o,e.fermentables),hops:s(o,e.hops)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FermentableTypes={grain:"Grain",sugar:"Sugar",extract:"Extract",dryExtract:"Dry Extract",adjunct:"Adjunct"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MashType={infusion:"Infusion",temperature:"Temperature",decoction:"Decoction"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.YeastTypes={ale:"Ale",lager:"Lager",wheat:"Wheat",wine:"Wine",champagne:"Champagne"},t.YeastForms={liquid:"Liquid",dry:"Dry",slant:"Slant",culture:"Culture"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.HopUse={boil:"Boil",dryHop:"DryHop",mash:"Mash",firstWort:"FirstWort",aroma:"Aroma"},t.HopForms={pellet:"Pellet",plug:"Plug",leaf:"Leaf"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.YeastTypes=t.YeastForms=t.MashType=t.HopUse=t.HopForms=t.RecipeTypes=t.FermentableTypes=t.calcWaterChemistry=t.calculateVolumes=t.scaleRecipe=t.sum=t.platoTosg=t.sgToPlato=t.psiTokpa=t.kpaToPsi=t.celsiusToFahrenheit=t.fahrenheitToCelsius=t.litersToGallons=t.ouncesToLiters=t.litersToOunces=t.poundsTokg=t.kgToPounds=t.kgToOunces=t.mashRecalculate=t.bitternessIbuRager=t.ragerHopIbu=t.bitternessRatio=t.bitternessIbuTinseth=t.calcCalories=t.carbonation=t.yeastStarterGrow=t.yeastCount=t.yeastNeeded=t.srmToCss=t.colorSRM=t.srmToRgb=t.estABVrealExtract=t.estABV=t.estABW=t.gravityPoints=t.boilGravity=t.finalGravity=t.originalGravity=void 0;var n=r(6),o=r(7),a=r(8),s=r(0),u=r(9),i=r(10),c=r(1),l=r(4),p=r(2),f=r(11),m=r(3);t.originalGravity=n.originalGravity,t.finalGravity=n.finalGravity,t.boilGravity=n.boilGravity,t.gravityPoints=n.gravityPoints,t.estABW=n.estABW,t.estABV=n.estABV,t.estABVrealExtract=n.estABVrealExtract,t.srmToRgb=n.srmToRgb,t.colorSRM=n.colorSRM,t.srmToCss=n.srmToCss,t.yeastNeeded=n.yeastNeeded,t.yeastCount=n.yeastCount,t.yeastStarterGrow=n.yeastStarterGrow,t.carbonation=n.carbonation,t.calcCalories=n.calcCalories,t.bitternessIbuTinseth=o.bitternessIbuTinseth,t.bitternessRatio=o.bitternessRatio,t.ragerHopIbu=o.ragerHopIbu,t.bitternessIbuRager=o.bitternessIbuRager,t.mashRecalculate=a.mashRecalculate,t.kgToOunces=s.kgToOunces,t.kgToPounds=s.kgToPounds,t.poundsTokg=s.poundsTokg,t.litersToOunces=s.litersToOunces,t.ouncesToLiters=s.ouncesToLiters,t.litersToGallons=s.litersToGallons,t.fahrenheitToCelsius=s.fahrenheitToCelsius,t.celsiusToFahrenheit=s.celsiusToFahrenheit,t.kpaToPsi=s.kpaToPsi,t.psiTokpa=s.psiTokpa,t.sgToPlato=s.sgToPlato,t.platoTosg=s.platoTosg,t.sum=s.sum,t.scaleRecipe=s.scaleRecipe,t.calculateVolumes=u.calculateVolumes,t.calcWaterChemistry=i.calcWaterChemistry,t.FermentableTypes=c.FermentableTypes,t.RecipeTypes=f.RecipeTypes,t.HopForms=l.HopForms,t.HopUse=l.HopUse,t.MashType=p.MashType,t.YeastForms=m.YeastForms,t.YeastTypes=m.YeastTypes},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calcCalories=t.carbonation=t.yeastStarterGrow=t.yeastCount=t.yeastNeeded=t.srmToCss=t.colorSRM=t.srmToRgb=t.estABVrealExtract=t.estABV=t.estABW=t.gravityPoints=t.boilGravity=t.finalGravity=t.originalGravity=void 0;var n=r(1),o=r(0),a=r(3),s=(t.originalGravity=function(e,t){return 1+t/(0,o.litersToGallons)(e)},t.finalGravity=function(e,t){return 1+t/(0,o.litersToGallons)(e)},t.boilGravity=function(e,t,r){return 1+(r-1)*(0,o.litersToGallons)(e)/(0,o.litersToGallons)(t)},function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(e-1)*(0,o.kgToPounds)(t)*r}),u=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e===n.FermentableTypes.extract||e===n.FermentableTypes.sugar||e===n.FermentableTypes.dryExtract?r:t},i=(t.gravityPoints=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,o.sum)(e.map(function(e){var n=e.type,o=e.potential,a=e.amount;return s(o,a,(1-r)*u(n,t))}))},t.estABW=function(e,t){return.105*(e-t)},t.estABV=function(e,t){return.132*(e-t)},t.estABVrealExtract=function(e,t){var r=(0,o.sgToPlato)(e);return(r-(.1808*r+.8192*(0,o.sgToPlato)(t)))/(2.0665-.010665*r)*(t/.79661)},function(e){return 1.4922*Math.pow(e,.6859)}),c=function(e){var t=e.amount,r=e.color;return(0,o.kgToPounds)(t)*r},l=t.srmToRgb=function(e){return{r:Math.round(Math.min(255,Math.max(0,255*Math.pow(.975,e)))),g:Math.round(Math.min(255,Math.max(0,255*Math.pow(.88,e)))),b:Math.round(Math.min(255,Math.max(0,255*Math.pow(.7,e))))}},p=(t.colorSRM=function(e,t){return i((0,o.sum)(e.map(c))/(0,o.litersToGallons)(t))},t.srmToCss=function(e){var t=l(e);return"rgb("+t.r+", "+t.g+", "+t.b+")"},t.yeastNeeded=function(e,t,r){return e*(1e3*t)*r/1e3},function(e,t){return 100-.7*Math.floor((Date.parse(e)-Date.parse(t))/864e5)}),f=(t.yeastCount=function(e){var t=e.amount,r=e.form,n=e.cultureDate,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(new Date).toString(),s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;switch(r){case a.YeastForms.dry:return s*t*1e3;case a.YeastForms.liquid:return p(o,n)/100*100*t;case a.YeastForms.slant:return u*t*1e3;default:throw new Error("NotImplementedError")}},function(e){return 2.33-.67*e}),m=function(e){return e<1.4?1.4:e>=1.4&&e<=3.5&&f(e)>0?f(e):0},d=(t.yeastStarterGrow=function(e,t,r,n){var a=(0,o.litersToGallons)(t),s=a*(r-1)*1e3,u=s/42,i=1e3*(0,o.poundsTokg)(u),c=e/i,l=m(c),p=i*l+e;return{growthRate:l,endingCount:p,pitchRate:1e3*p/(0,o.sgToPlato)(r)/(n/1e3)}},function(e,t){return Math.max(0,-16.6999-.0101059*t+.00116512*t*t+.173354*t*e+4.24267*e-.0684226*e*e)}),h=function(e,t,r){return 15.195*r*(e-3.0378+.050062*t-26555e-8*t*t)},T=function(e){return Math.max(32,(0,o.celsiusToFahrenheit)(e))},g=(t.carbonation=function(e,t,r){var n=h(e,T(t),(0,o.litersToGallons)(r));return{kegPressure:d(e,T(t)),kegSugar:.5*n,cornSugar:n,dme:1.538*n}},function(e,t){return 1881.22*t*((e-t)/(1.775-e))}),y=function(e,t){return 3550*t*(.1808*e+.8192*t-1.0004)};t.calcCalories=function(e,t){return g(e,t)+y(e,t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bitternessIbuRager=t.ragerHopIbu=t.bitternessRatio=t.bitternessIbuTinseth=void 0;var n=r(0),o=r(4),a=function(e,t,r){return 1.65*r*Math.pow(125e-6,e)*(1-Math.pow(Math.E,-.04*t))/4.15},s=(t.bitternessIbuTinseth=function(e,t,r){return(0,n.sum)(e.map(function(e){var s=e.amount,u=e.alpha,i=e.form,c=e.time;return a(t,c,i===o.HopForms.pellet?1.1:1)*(0,n.kgToOunces)(s)*u*7490/(0,n.litersToGallons)(r)}))},t.bitternessRatio=function(e,t){return e/t},function(e){return e<=1.05?0:(e-1.05)/.2}),u=function(e){return 18.11+13.86*Math.tanh((e-31.32)/18.27)},i=function(e,t,r,n,o,a){return e*t*r*a/(n*(1+o))},c=t.ragerHopIbu=function(e,t,r,n,o){return r<=0||e<=0||t<0?0:i(.01*u(Math.floor(r+.5)),t,e,o,s(n),100/1.34)};t.bitternessIbuRager=function(e,t,r){return(0,n.sum)(e.map(function(e){var o=e.amount,a=e.alpha,s=e.time;return c((0,n.kgToOunces)(o),100*a,s,t,(0,n.litersToGallons)(r))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mashRecalculate=void 0;var n=r(2),o=function(e,t){return e*t+(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0)+(arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)},a=function(e,t,r){return e*=.8,e>0&&t<e?r*t/e:r},s=function(e,t,r,n,s,u,i,c){var l=o(.652,n,t),p=a(i,l,s),f=(.38*n+u*p+t)/(.38*n+t)*(e-r)/(c-r);return f>1&&(f=1),l*f},u=function(e,t,r,n,s,u,i,c){if(e<=0)return t;var l=o(.652,s,e,r);return t+(.38*s+i*a(c,l,u)+r)*(t-n)/e},i=function(e,t,r,n,s,u,i,c){if(0===e)return t;var l=o(.652,r,e);return t+(.38*r*(t-n)+u*a(i,l,s)*(t-c))/e};t.mashRecalculate=function(e,t,r){var o=e.mashSteps,a=e.equipAdjust,c=e.grainTemp,l=e.tunTemp,p=t.tunWeight,f=t.tunSpecificHeat,m=t.tunVolume,d=a?p:0,h=function(e,t){return 0===e?t+0:t},T=function(e,t){return t.slice(0,e).reduce(function(e,t,r){return t.type!==n.MashType.decoction?h(r,t.infuseAmount):0},0)};return o.map(function(e,t,o){var a=(e.name,e.type),p=e.infuseAmount,g=e.stepTemp,y=h(t,p),b=T(t,o),v={};switch(a){case n.MashType.infusion:v.infussionTemp=0===t?i(y,g,r,c,d,f,m,l):u(y,g,b,o[t-1].stepTemp,r,d,f,m),v.decoctionAmount=0;break;case n.MashType.decoction:v.infussionTemp=0===t?i(y,g,r,c,d,f,m,l):0,v.decoctionAmount=0===t?0:s(g,b,o[t-1].stepTemp,r,d,f,m,100)}return{infuseStepAmount:y,infussionTemp:v.infussionTemp,decoctionAmount:v.decoctionAmount}})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateVolumes=void 0;var n=r(0),o=r(1),a=r(2);t.calculateVolumes=function(e,t){var r=e.fermentables,s=e.mash,u=e.boilTime,i=t.lauterDeadspace,c=t.boilSize,l=t.evapRate,p=t.coolingLossPct,f=t.trubChillerLoss,m=t.topUpKettle,d=t.BIAB,h=(0,n.sum)(r.map(function(e){var t=e.amount;return e.type===o.FermentableTypes.grain?t:0})),T=d?.586:.96,g=(0,n.ouncesToLiters)((0,n.kgToOunces)(h)*T),y=i+(0,n.sum)(s.mashSteps.map(function(e){var t=e.type,r=e.infuseAmount;return t!==a.MashType.decoction?r:0})),b=y+.67*h,v=y-g,M=c+g-m+i-y,C=v+(M-i),O=C*l*(u/60),P=C-O,G=P*p;return{totalWater:y+M,mashGrainWeight:h,grainAbsorbtion:g,totalMashWaterAdds:y,mashVolumeNeeded:b,waterAvailFromMash:v,spargeVol:M,estPreBoilVolume:C,boilOffVolume:O,postBoilVolume:P,coolingShrinkage:G,estBottlingVol:P-G-f-0-1.7}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calcWaterChemistry=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=r(0),a=function(e,t){return Math.round(e*(1-t))},s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Math.round(e*(1-t)*(50/61))},u=function(e,t){var r=t.CaCO3,n=t.NaHCO3,o=t.CaSO4,a=t.CaCl2,u=t.MgSO4,i=t.NaCl,c=0,l=0,p=0,f=0,m=0,d=0;return r/=2,r>0&&(c+=105*r/e,d+=321*r/e),n>0&&(f+=75*n/e,d+=191*n/e),o>0&&(c+=61.5*o/e,p+=147.4*o/e),a>0&&(c+=72*a/e,m+=127*a/e),u>0&&(l+=26*u/e,p+=103*u/e),i>0&&(f+=104*i/e,m+=160*i/e),{name:"adjustmentsFromSalts",Ca:Math.round(c),Mg:Math.round(l),SO4:Math.round(p),Na:Math.round(f),Cl:Math.round(m),HCO3:Math.round(d),alkalinity:s(Math.round(d))}};t.calcWaterChemistry=function(e,t,r,i,c){var l=u((0,o.litersToGallons)(e),n({},c)),p={name:"dilutedWater",Ca:a(r.Ca,t),Mg:a(r.Mg,t),SO4:a(r.SO4,t),Na:a(r.Na,t),Cl:a(r.Cl,t),HCO3:a(r.HCO3,t),alkalinity:s(r.HCO3,t)},f={name:"adjustedWater",Ca:p.Ca+l.Ca,Mg:p.Mg+l.Mg,SO4:p.SO4+l.SO4,Na:p.Na+l.Na,Cl:p.Cl+l.Cl,HCO3:p.HCO3+l.HCO3,alkalinity:s(p.HCO3+l.HCO3)};return{adjustedWater:f,dilutedWater:p,adjustmentsFromSalts:l,difference:{name:"difference source water from target",Ca:f.Ca-i.Ca,Mg:f.Mg-i.Mg,SO4:f.SO4-i.SO4,Na:f.Na-i.Na,Cl:f.Cl-i.Cl,HCO3:f.HCO3-i.HCO3,alkalinity:s(f.HCO3-i.HCO3)},sulphateChlorideRatio:f.SO4/f.Cl}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RecipeTypes={extract:"Extract",partialMash:"Partial Mash",allGrain:"All Grain"}}])});